{% extends 'base.html' %}
{% load static %}

{% block title %}{{ terms.title }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-12">
    <div class="mb-12">
        <div class="text-center mb-8">
            {% if terms.image %}
            <div class="mb-6">
                <img src="{{ terms.image.url }}" alt="{{ terms.title }}" class="mx-auto rounded-lg shadow-md max-h-64 object-cover">
            </div>
            {% endif %}
            
            <h1 class="text-4xl font-bold text-gray-900 mt-3 mb-4">{{ terms.title }}</h1>
            <p class="text-gray-600">Last updated: {{ terms.last_updated|date:"F d, Y" }}</p>
        </div>

        {% if terms.description %}
        <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
            <p class="text-gray-700">{{ terms.description }}</p>
        </div>
        {% endif %}
    </div>

    <div class="space-y-8">
        {% for section in terms.sections.all %}
        <section id="{{ section.section_id }}" class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">{{ section.section_number }}. {{ section.section_title }}</h2>
            <div class="space-y-4 text-gray-700">
                {% regroup section.contents.all by content_type as content_groups %}
                
                {% for group in content_groups %}
                    {% if group.grouper == 'paragraph' %}
                        {% for content in group.list %}
                            <p>{{ content.text|linebreaks }}</p>
                        {% endfor %}
                    {% elif group.grouper == 'list_item' %}
                        <ul class="list-disc list-inside space-y-2 ml-4">
                            {% for content in group.list %}
                                <li>{{ content.text }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                {% endfor %}
            </div>
        </section>
        {% endfor %}
    </div>

    {% if terms.contact_info %}
    <div class="mt-8 space-y-8">
        <section id="contact" class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">{{ terms.sections.count|add:1 }}. Contact Information</h2>
            <div class="space-y-4 text-gray-700">
                <p>If you have any questions about these Terms and Services, please contact us:</p>
                <div class="bg-gray-50 rounded-lg p-4 mt-4">
                    <p class="font-semibold text-gray-900 mb-2">{{ terms.contact_info.organization_name }}</p>
                    <p class="text-gray-700">Email: {{ terms.contact_info.email }}</p>
                    <p class="text-gray-700">Phone: {{ terms.contact_info.phone }}</p>
                    <p class="text-gray-700">Address: {{ terms.contact_info.address|linebreaks }}</p>
                </div>
            </div>
        </section>
    </div>
    {% endif %}

    <div class="mt-12 bg-white rounded-lg shadow-sm p-6 text-center">
        <p class="text-sm text-gray-600">
            By using our services, you acknowledge that you have read, understood, and agree to be bound by these Terms and Services.
        </p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{% endblock %}
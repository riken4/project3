{% extends 'base.html' %}
{% load static %}

{% block title %}{{ page.title|default:"Our Team" }}{% endblock %}

{% block extra_css %}
<style>
    .flip-card-wrapper {
        position: relative;
        width: 100%;
        aspect-ratio: 4 / 5;
    }

    .perspective-1000 {
        perspective: 1000px;
    }

    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.8s;
        transform-style: preserve-3d;
    }

    .flip-card-wrapper:hover .flip-card-inner {
        transform: rotateY(180deg);
    }

    .flip-card-front,
    .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
    }

    .backface-hidden {
        backface-visibility: hidden;
    }

    .flip-card-back {
        transform: rotateY(180deg);
    }

    .team-card,
    .detail-container {
        height: 100%;
        width: 100%;
        box-sizing: border-box;
    }

    .card-hover {
        transition: all 0.3s ease;
    }

    .card-hover:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    }

    .social-icon {
        transition: all 0.3s ease;
    }

    .social-icon:hover {
        transform: scale(1.2);
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
{% if page %}
<!-- Hero Banner with Dynamic Image -->
<section class="relative flex items-center justify-center bg-cover bg-center bg-fixed h-screen overflow-hidden" 
    style="background-image: url('{% if page and page.image %}{{ page.image.url }}{% else %}{% static 'image/bg6.jpg' %}{% endif %}');">
    <div class="absolute inset-0 bg-gradient-to-b from-black/50 via-black/40 to-black/50"></div>
    <div class="max-w-7xl mx-auto w-full text-center relative z-10 px-4">
        <h1 class="text-white text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold mb-3 sm:mb-4 lg:mb-6 animate-fade-in">
            {% if page %}{{ page.title }}{% else %}Our Team{% endif %}
        </h1>
        <p class="text-white text-sm sm:text-base md:text-lg lg:text-xl mb-4 sm:mb-5 lg:mb-8 max-w-3xl mx-auto">
            {% if page %}{{ page.description }}{% else %}Learn more about our team members{% endif %}
        </p>
    </div>
</section>
{% endif %}

<!-- Add this to your extra_css block -->
<style>
    .flip-card-wrapper {
        position: relative;
        width: 100%;
        aspect-ratio: 4 / 5;
    }

    .perspective-1000 {
        perspective: 1000px;
    }

    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.8s;
        transform-style: preserve-3d;
    }

    .flip-card-wrapper:hover .flip-card-inner {
        transform: rotateY(180deg);
    }

    .flip-card-front,
    .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
    }

    .backface-hidden {
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
    }

    .flip-card-back {
        transform: rotateY(180deg);
    }

    .team-card,
    .detail-container {
        height: 100%;
        width: 100%;
        box-sizing: border-box;
    }

    /* Critical: Make all elements in back clickable */
    .flip-card-back,
    .flip-card-back * {
        pointer-events: auto !important;
    }

    /* Prevent front side from interfering */
    .flip-card-wrapper:hover .flip-card-front {
        pointer-events: none;
    }

    /* Enhanced social icon animations */
    .social-icon {
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        z-index: 100;
    }

    /* Ripple effect on hover */
    .social-icon::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        transform: translate(-50%, -50%) scale(0);
        transition: transform 0.5s ease;
        z-index: -1;
    }

    .social-icon:hover::before {
        transform: translate(-50%, -50%) scale(1.5);
        opacity: 0;
    }

    /* Facebook animations */
    .social-icon.facebook::before {
        background: rgba(24, 119, 242, 0.3);
    }

    .social-icon.facebook:hover {
        background: #1877F2;
        transform: translateY(-8px) scale(1.2) rotate(5deg);
        box-shadow: 0 10px 25px rgba(24, 119, 242, 0.5);
    }

    .social-icon.facebook:hover i {
        color: white !important;
        animation: bounce 0.6s ease;
    }

    /* Instagram animations */
    .social-icon.instagram::before {
        background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%, #d6249f 60%, #285AEB 90%);
        opacity: 0.3;
    }

    .social-icon.instagram:hover {
        background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%, #d6249f 60%, #285AEB 90%);
        transform: translateY(-8px) scale(1.2) rotate(-5deg);
        box-shadow: 0 10px 25px rgba(214, 36, 159, 0.5);
    }

    .social-icon.instagram:hover i {
        color: white !important;
        animation: shake 0.6s ease;
    }

    /* Twitter animations */
    .social-icon.twitter::before {
        background: rgba(29, 161, 242, 0.3);
    }

    .social-icon.twitter:hover {
        background: #1DA1F2;
        transform: translateY(-8px) scale(1.2) rotate(5deg);
        box-shadow: 0 10px 25px rgba(29, 161, 242, 0.5);
    }

    .social-icon.twitter:hover i {
        color: white !important;
        animation: swing 0.6s ease;
    }

    /* LinkedIn animations */
    .social-icon.linkedin::before {
        background: rgba(0, 119, 181, 0.3);
    }

    .social-icon.linkedin:hover {
        background: #0077B5;
        transform: translateY(-8px) scale(1.2) rotate(-5deg);
        box-shadow: 0 10px 25px rgba(0, 119, 181, 0.5);
    }

    .social-icon.linkedin:hover i {
        color: white !important;
        animation: pulse 0.6s ease;
    }

    /* Animation keyframes */
    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
    }

    @keyframes shake {
        0%, 100% { transform: rotate(0deg); }
        25% { transform: rotate(-10deg); }
        75% { transform: rotate(10deg); }
    }

    @keyframes swing {
        0%, 100% { transform: rotate(0deg); }
        25% { transform: rotate(15deg); }
        75% { transform: rotate(-15deg); }
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }

    /* Glow effect on social container */
    .social-links-container {
        position: relative;
    }

    .social-links-container::after {
        content: '';
        position: absolute;
        inset: -10px;
        background: linear-gradient(45deg, #1877F2, #E1306C, #1DA1F2, #0077B5);
        border-radius: 20px;
        opacity: 0;
        z-index: -1;
        filter: blur(20px);
        transition: opacity 0.5s ease;
    }

    .social-links-container:hover::after {
        opacity: 0.3;
        animation: rotate-gradient 3s linear infinite;
    }

    @keyframes rotate-gradient {
        0% { filter: blur(20px) hue-rotate(0deg); }
        100% { filter: blur(20px) hue-rotate(360deg); }
    }

    /* Contact info animations */
    .contact-item {
        transition: all 0.3s ease;
    }

    .contact-item:hover {
        transform: translateX(5px);
        background: rgba(59, 130, 246, 0.05);
        padding: 8px;
        border-radius: 8px;
        margin: -8px;
    }

    .contact-item i {
        transition: all 0.3s ease;
    }

    .contact-item:hover i {
        transform: scale(1.3) rotate(10deg);
    }
</style>

<!-- Team Members Section -->
<section class="py-20 bg-gradient-to-b from-gray-50 to-white">
    <div class="max-w-7xl mx-auto px-4">
        <div class="text-center mb-16">
            <h2 class="text-4xl sm:text-5xl font-bold text-gray-900 mb-4">Meet Our Team</h2>
            <p class="text-lg text-gray-600">The talented people behind our success</p>
            <div class="w-24 h-1 bg-gradient-to-r from-blue-400 to-purple-500 mx-auto rounded-full mt-4"></div>
        </div>
        
        {% if members %}
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            {% for member in members %}
            <!-- Team Member Card -->
            <div class="flip-card-wrapper perspective-1000">
                <div class="flip-card-inner">
                    <!-- Front Side -->
                    <div class="team-card flip-card-front backface-hidden">
                        <div class="relative rounded-2xl overflow-hidden shadow-xl hover:shadow-2xl cursor-pointer h-full transition-all duration-300 border border-gray-100">
                            {% if member.image %}
                            <img src="{{ member.image.url }}" 
                                 alt="{{ member.title }}"
                                 class="absolute inset-0 w-full h-full object-cover z-0" />
                            {% else %}
                            <div class="absolute inset-0 w-full h-full bg-gradient-to-br from-blue-400 via-blue-500 to-blue-600 z-0 flex items-center justify-center">
                                <span class="text-7xl font-bold text-white opacity-70">{{ member.title|first|upper }}</span>
                            </div>
                            {% endif %}
                            <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent z-0"></div>
                            <div class="relative z-10 flex items-end h-full p-6">
                                <div class="bg-white/95 backdrop-blur-sm rounded-xl p-4 w-full shadow-xl">
                                    <h3 class="font-bold text-lg text-gray-900">{{ member.title }}</h3>
                                    <p class="text-sm text-blue-600 font-semibold">{{ member.position }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Back Side -->
                    <div class="detail-container flip-card-back backface-hidden">
                        <div class="bg-white rounded-2xl shadow-2xl p-6 h-full flex flex-col justify-between border border-gray-100">
                            <div>
                                <h3 class="font-bold text-2xl text-gray-900 mb-1">{{ member.title }}</h3>
                                <p class="text-blue-600 font-semibold text-sm mb-4">{{ member.position }}</p>
                                
                                {% if member.description %}
                                <p class="text-gray-600 mb-4 text-sm leading-relaxed line-clamp-4">{{ member.description }}</p>
                                {% endif %}
                            </div>
                            
                            <div>
                                <div class="space-y-2 mb-4">
                                    {% if member.gmail %}
                                    <a href="mailto:{{ member.gmail }}" class="contact-item flex items-center text-sm group">
                                        <i class="fas fa-envelope text-blue-600 w-5 mr-3"></i>
                                        <span class="text-gray-700 hover:text-blue-600 transition-colors break-all flex-1">
                                            {{ member.gmail }}
                                        </span>
                                    </a>
                                    {% endif %}
                                    
                                    {% if member.phone_number %}
                                    <a href="tel:+977{{ member.phone_number }}" class="contact-item flex items-center text-sm group">
                                        <i class="fas fa-phone text-green-600 w-5 mr-3"></i>
                                        <span class="text-gray-700 hover:text-green-600 transition-colors flex-1">
                                            +977 {{ member.phone_number }}
                                        </span>
                                    </a>
                                    {% endif %}
                                    
                                    {% if member.location %}
                                    <div class="contact-item flex items-center text-sm">
                                        <i class="fas fa-map-marker-alt text-red-600 w-5 mr-3"></i>
                                        <span class="text-gray-700 flex-1">{{ member.location }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Social Links -->
                                {% if member.facebook_link or member.instagram_link or member.twitter_link or member.linkedin_link %}
                                <div class="pt-4 border-t border-gray-200">
                                    <p class="text-xs text-gray-500 mb-4 text-center font-medium uppercase tracking-wide">Connect with me</p>
                                    <div class="social-links-container flex justify-center items-center space-x-3">
                                        {% if member.facebook_link %}
                                        <a href="{% if 'http' in member.facebook_link %}{{ member.facebook_link }}{% else %}https://{{ member.facebook_link }}{% endif %}" 
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           class="social-icon facebook text-gray-600"
                                           title="Follow on Facebook">
                                            <i class="bi bi-facebook text-2xl"></i>
                                        </a>
                                        {% endif %}
                                        
                                        {% if member.instagram_link %}
                                        <a href="{% if 'http' in member.instagram_link %}{{ member.instagram_link }}{% else %}https://{{ member.instagram_link }}{% endif %}" 
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           class="social-icon instagram text-gray-600"
                                           title="Follow on Instagram">
                                            <i class="bi bi-instagram text-2xl"></i>
                                        </a>
                                        {% endif %}
                                        
                                        {% if member.twitter_link %}
                                        <a href="{% if 'http' in member.twitter_link %}{{ member.twitter_link }}{% else %}https://{{ member.twitter_link }}{% endif %}" 
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           class="social-icon twitter text-gray-600"
                                           title="Follow on Twitter">
                                            <i class="bi bi-twitter text-2xl"></i>
                                        </a>
                                        {% endif %}
                                        
                                        {% if member.linkedin_link %}
                                        <a href="{% if 'http' in member.linkedin_link %}{{ member.linkedin_link }}{% else %}https://{{ member.linkedin_link }}{% endif %}" 
                                           target="_blank"
                                           rel="noopener noreferrer"
                                           class="social-icon linkedin text-gray-600"
                                           title="Connect on LinkedIn">
                                            <i class="bi bi-linkedin text-2xl"></i>
                                        </a>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- Empty State -->
        <div class="text-center py-20">
            <div class="inline-flex items-center justify-center w-24 h-24 bg-gradient-to-br from-blue-100 to-blue-50 rounded-full mb-6">
                <i class="fas fa-users text-blue-600 text-4xl"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-900 mb-3">No Team Members Yet</h3>
            <p class="text-gray-600 text-lg">Our team is growing. Check back soon to meet our talented members!</p>
        </div>
        {% endif %}
    </div>
</section>

<!-- Add this JavaScript at the bottom of your template or in extra_js block -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Ensure all links in flipped cards are clickable
    const flipCards = document.querySelectorAll('.flip-card-wrapper');
    
    flipCards.forEach(card => {
        const backSide = card.querySelector('.flip-card-back');
        const allLinks = backSide.querySelectorAll('a');
        
        // Make sure links work even during flip animation
        allLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.stopPropagation();
                // Force link to work
                if (this.href) {
                    window.open(this.href, this.target || '_blank');
                }
            });
            
            // Prevent any parent elements from interfering
            link.addEventListener('mousedown', function(e) {
                e.stopPropagation();
            });
        });
    });

    // Add click feedback for social icons
    const socialIcons = document.querySelectorAll('.social-icon');
    socialIcons.forEach(icon => {
        icon.addEventListener('click', function(e) {
            // Visual feedback
            this.style.transform = 'scale(0.9)';
            setTimeout(() => {
                this.style.transform = '';
            }, 150);
        });
    });

    // Prevent card from flipping when clicking on the back side
    const backSides = document.querySelectorAll('.flip-card-back');
    backSides.forEach(back => {
        back.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    });
});
</script>

<!-- CTA Section -->
{% if members %}
<section class="py-20 bg-gradient-to-br from-green-100 via-green-50 to-blue-50">
    <div class="container mx-auto px-4 text-center">
        <h2 class="text-4xl font-bold mb-6 text-gray-900">Want to Join Our Team?</h2>
        <p class="text-xl mb-10 text-gray-700 max-w-2xl mx-auto">
            We're always looking for talented individuals to join our growing team<br/>
            Mail us and we will get back to you
        </p>
    </div>
</section>
{% endif %}

{% endblock %}

{% block extra_js %}
{% endblock %}